IMPLEMENTATION PLAN

PHASE 0 – FOUNDATIONS
- Select one laptop as coordinator
- Install: Python 3.11, Ray, LangGraph, Redis, NATS
- Install Ollama or LM Studio on all laptops
- Verify LAN connectivity and mDNS discovery

PHASE 1 – MINIMAL DISTRIBUTED EXECUTION
- Start Ray head on coordinator
- Register laptop workers as Ray workers
- Implement simple task schema (task_id, type, payload)
- Route tasks manually to workers
- Aggregate plain-text responses
- REST endpoint: /chat

PHASE 2 – PLANNER + DAG
- Add planner LLM for task decomposition
- Represent tasks as LangGraph DAG
- Implement task fan-out and join
- Add retry-on-failure logic
- Store intermediate results in Redis

PHASE 3 – MESSAGING + HEALTH
- Introduce NATS for heartbeat and task events
- Implement worker capability registration
- Drop and reschedule tasks on node failure
- Add simple metrics collection

PHASE 4 – ANDROID INTEGRATION
- Build PWA with WebSocket client
- Support relay + tool-only execution
- Add best-effort task participation
- Visualize active mobile nodes

PHASE 5 – MCP SERVER MODE
- Expose coordinator as MCP server
- Map MCP tool calls to task DAGs
- Enable IDE-based agent workflows

PHASE 6 – OBSERVABILITY
- Add task timeline visualization
- Add node load and latency charts
- Persist logs for replay and analysis

PHASE 7 – EXPERIMENTATION
- Compare heterogeneous models per task
- Experiment with planner strategies
- Simulate node churn and failures
- Extend tool ecosystem

EXIT CRITERIA
- Distributed task execution across ≥3 devices
- Planner-driven decomposition working
- MCP integration functional
- Android nodes participating in at least relay mode

---
[ROLLBACK & IMPACT REPORT]
Date: Tue Jan 13 16:35:45 IST 2026

Features Removed (Stashed) during Phase 9-12 Rollback:

1. Phase 10: Dynamic Routing
   - Gone: Routes /web, /node, /chat_ui, /llmlab.
   - Gone: Files web_client.html, worker_node.html, web_worker.html.
   - Reverted: main.py is monolithic again.

2. Phase 10: Discovery & Startup
   - Gone: start_cluster.py (Smart Leader Election / Unified CLI).
   - Gone: coordinator/discovery.py (UDP Beacon).

3. Phase 11: Data Persistence
   - Gone: coordinator/persistence.py.
   - Gone: task_history persistence to history.json.

4. Phase 12: Unified Architecture
   - Gone: LLM_ROLE logic (Worker vs Coordinator mode).
   - Gone: /api/config endpoint (Dynamic WebSocket URL).

Current State:
- Back to 'Phase 9' state.
- main.py runs on localhost:8000.
- Manual 'ray start' required for workers.
